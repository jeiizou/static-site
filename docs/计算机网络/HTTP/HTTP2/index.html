<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-计算机网络/HTTP/HTTP2">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">HTTP2 | world</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://localhost:3000/docs/计算机网络/HTTP/HTTP2"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="HTTP2 | world"><meta data-rh="true" name="description" content="HTTP2 相比较于 HTTP1.X 大幅度的提升了 web 性能, 在于 HTTP1.1 完全兼容的基础上, 进一步减少了网络延迟, 而对于前端开发人员来说, 无疑减少了在前端方面的优化工作."><meta data-rh="true" property="og:description" content="HTTP2 相比较于 HTTP1.X 大幅度的提升了 web 性能, 在于 HTTP1.1 完全兼容的基础上, 进一步减少了网络延迟, 而对于前端开发人员来说, 无疑减少了在前端方面的优化工作."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://localhost:3000/docs/计算机网络/HTTP/HTTP2"><link data-rh="true" rel="alternate" href="https://localhost:3000/docs/计算机网络/HTTP/HTTP2" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://localhost:3000/docs/计算机网络/HTTP/HTTP2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="world RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="world Atom Feed"><link rel="stylesheet" href="/assets/css/styles.5d8c6f17.css">
<link rel="preload" href="/assets/js/runtime~main.5d46ccd1.js" as="script">
<link rel="preload" href="/assets/js/main.a052ef5d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_B8Ea">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbarHideable_cmch"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Jeiiz&#x27;s World</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Wiki</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="toggle_Wbdk colorModeToggle_qKyZ"><button class="clean-btn toggleButton_ZMwS toggleButtonDisabled_bkOl" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v5D6"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_ZxuA"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_aLgs"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_Bh6J docsWrapper_Q1yX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_wVrL" type="button"></button><div class="docPage_ZAu3"><aside class="theme-doc-sidebar-container docSidebarContainer_ZFCQ"><div class="sidebar_d_V8 sidebarWithHideableNavbar_DHfV"><a tabindex="-1" class="sidebarLogo_VhE4" href="/"><b>Jeiiz&#x27;s World</b></a><nav class="menu thin-scrollbar menu_mA06"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/信息安全/网络安全/安全-常见安全策略">信息安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/其他/Git/Git-GitFlow">其他</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/前端基础/CSS/原理-像素与单位">前端基础</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/前端生态/前端工程/Babel/Babel-插件">前端生态</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/图形学/WebGL-GLSL语法">图形学</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/数据结构与算法/DFS&amp;BFS">数据结构与算法</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/服务端/Nginx常用配置">服务端</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/架构&amp;模式&amp;工程/ShapeUp工作流">架构&amp;模式&amp;工程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/计算机网络/CDN原理">计算机网络</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/计算机网络/CDN原理">CDN原理</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/计算机网络/HTTP/">HTTP</a><button aria-label="打开/收起侧边栏菜单「HTTP」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/计算机网络/HTTP/HTTP2">HTTP2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/计算机网络/HTTP/HTTP3">HTTP3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/计算机网络/HTTP/HTTPS">HTTPS</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/计算机网络/TCP&amp;UDP">TCP&amp;UDP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/计算机网络/WebSocket">WebSocket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/计算机网络/上传与下载">上传与下载</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/计算机网络/网络模型概述">网络模型概述</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_l9Db"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_lDak"><div class="docItemContainer_Nuls"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_MUoR" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_API8"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">计算机网络</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/计算机网络/HTTP/"><span itemprop="name">HTTP</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">HTTP2</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_FtTS theme-doc-toc-mobile tocMobile_l5fy"><button type="button" class="clean-btn tocCollapsibleButton_Dnbe">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>HTTP2</h1><p>HTTP2 相比较于 HTTP1.X 大幅度的提升了 web 性能, 在于 HTTP1.1 完全兼容的基础上, 进一步减少了网络延迟, 而对于前端开发人员来说, 无疑减少了在前端方面的优化工作.</p><p>具体的文档在这里: <a href="https://http2.akamai.com/demo" target="_blank" rel="noopener noreferrer">HTTP/2: the Future of the Internet</a></p><p>技术方案在这里: <a href="https://httpwg.org/specs/rfc7541.html" target="_blank" rel="noopener noreferrer">RFC 7541</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="多路复用">多路复用<a class="hash-link" href="#多路复用" title="标题的直接链接">​</a></h2><p>众所周知,在 HTTP/1.1 协议中, 浏览器客户端在同一时间. 针对同一域名下的请求有一定数量限制。超过限制数目的请求会被阻塞.</p><p>HTTP2 的多路复用则允许通过单一的 HTTP2 链接发起多重的<code>请求-响应</code>的消息.</p><p><img loading="lazy" alt="image" src="/assets/images/b1e608ddb7493608efea3e76912aabe1_hd-f1ad4418a296ab7bef76ac64a382e6ae.jpg" width="720" height="714" class="img_wb0S"></p><p>因此 HTTP2 可以很容易的实现<strong>多流并行</strong>而不用依赖建立多个 TCP 链接, HTTP/2 把 HTTP 协议通信的基本单位缩小为一个一个的帧, 这些帧对应逻辑流中的消息, 并行的在同一个 TCP 连接上双向交换消息.</p><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="二进制分帧">二进制分帧<a class="hash-link" href="#二进制分帧" title="标题的直接链接">​</a></h2><p>HTTP2 在兼容 HTTP1.X 的情况下, 在应用层(HTTP/2)和传输层(TCP/UDP)之间增加了一个二进制分帧层.</p><p><img loading="lazy" alt="image" src="/assets/images/906e22193e61cd561325d93aae0f1e07_hd-271d6677a48bd3614f48c3d760ab2257.jpg" width="625" height="324" class="img_wb0S"></p><p>在这个二进制分帧层中, HTTP2 会将所有传输的信息分割为更小的消息和帧(frame), 并对他们采用二进制格式的编码, 其中 HTTP1.x 的首部信息会被封装到<code>HEADER frame</code>, 而相应的 <code>Request Body</code> 则封装到 <code>DATA frame</code> 里面.</p><p>HTTP/2 通信都在一个连接上完成, 这个连接可以承载任意数量的双向数据流.</p><p>在 1.X 版本中, HTTP 性能优化的关键并不在于高带宽, 而是低延迟. TCP 连接会随着时间进行自我调节, 期初会限制连接的最大速度, 如果数据传输成功, 会随着时间的推移提高传输的速度. 这种调谐被称为 <code>TCP 慢启动</code>.</p><p>HTTP2 通过让所有数据流共用一个连接, 可以更有效的使用 TCP 连接, 让高带宽服务于 HTTP 的性能提升.</p><p>总之:</p><ol><li>单连接多资源的方式, 减少了服务端的压力, 内存占用更少, 连接吞吐量更大</li><li>由于 TCP 的连接的减少而使用网络拥塞状况得以改善, 同时慢启动时间的减少, 使得拥塞和丢包恢复速度更快.</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="请求优先级">请求优先级<a class="hash-link" href="#请求优先级" title="标题的直接链接">​</a></h2><p>把HTTP消息分为很多独立帧之后, 就可以通过优化这些帧的交错和传输顺序进一步优化性能. 每一个流都可以带一个31比特的优先值: 0表示最高优先级, <code>2^31 - 1</code>表示最低优先级.</p><p><strong>权重</strong>:  服务器可以根据流的优先级, 控制资源分配(CPU, 内存, 带宽), 而在响应数据准备好之后, 优先级将最高优先级的帧发送给客户端. 高优先级的流会优先发送. 但也不是绝对的, 因为会引入首队阻塞的问题: 高优先级的请求导致阻塞其他资源的交付.</p><p>分配处理资源和客户端与服务器之间的带宽, 不同优先级的混合也是必须的. 客户端可以指定哪个流是重要的.</p><p><strong>流依赖关系</strong>: 每个流都可以明确的依赖另一个流, 客户端会使用权重和流依赖关系的组合信息, 向服务端构造和传递&quot;优先级树&quot;. 这个树表明了其希望如何接受响应. 即我们期望优先级越高的请求越快得到响应.</p><p>浏览器中有一个默认的优先级。浏览器基于自身对资源重要性的判读: </p><ul><li>优先级最高: html</li><li>优先级高: css</li><li>优先级中: js</li><li>优先级低: 图片等其他资源</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="首部压缩">首部压缩<a class="hash-link" href="#首部压缩" title="标题的直接链接">​</a></h2><p>HTTP1.X 不支持首部压缩, 因此 SPDY 和 HTTP2 应运而生, SPDY 使用的是 DEFLATE 算法, HTTP2 则使用了专门的 HPACK 算法. 减少了 header 的大小。并在两端维护了索引表，用于记录出现过的 header ，后面在传输过程中就可以传输已经记录过的 header 的键名，对端收到数据后就可以通过键名找到对应的值。</p><h3 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="为什么要压缩">为什么要压缩<a class="hash-link" href="#为什么要压缩" title="标题的直接链接">​</a></h3><p>在HTTP/1 中, HTTP请求和响应都是由<code>状态行</code>, <code>请求/响应头部</code>, <code>消息主题</code> 三部分组成的. 一般而言, 消息主体都会经过gzip压缩, 或者本身传输的就是压缩过后的二进制文件(比如图片, 视频), 但状态行和头部却没有经过任何压缩, 而直接以纯文本传输</p><p>随着web功能越来越复杂, 每个页面产生的请求数量也越来越多. 根据HTTP Archive的统计, 当前平均每个页面都会产生上百个请求. 越来越多的请求导致消耗的头部的流量越来越多.</p><p>在HTTP/1时代, 为了减少头部消耗的流量, 有很多优化方案可以尝试, 例如合并请求, 启用Cookie-Free域名等等, 但是这些方案多少有点问题. </p><h3 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="技术原理">技术原理<a class="hash-link" href="#技术原理" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="image" src="/assets/images/hpack-header-compression-78fa87385183998d0a8f58cd67a0d1c3.png" width="1600" height="949" class="img_wb0S"></p><p>通俗的来说, 头部压缩需要在支持HTTP/2的浏览器和服务端之间:</p><ul><li>维护一份相同的静态字典(Static Table), 包含常见的头部名称, 以及特别常见的头部名称和值的组合</li><li>维护一份相同的动态字典(Dynamic Table), 可以动态的添加内容</li><li>支持基于静态哈夫曼码表的哈夫曼编码(Huffman Coding)</li></ul><p>静态字典的作用有两个:</p><ol><li>对于完全匹配的头部键值对, 例如: method: GET, 可以直接使用一个字符表示</li><li>对于头部名称可以匹配的键值对, 例如cookie: xxxx, 可以将名称使用一个字符表示. </li></ol><p>HTTP/2中的静态字典大致如下(<a href="https://httpwg.org/specs/rfc7541.html#static.table.definition" target="_blank" rel="noopener noreferrer">https://httpwg.org/specs/rfc7541.html#static.table.definition</a>):</p><table><thead><tr><th>Index</th><th>Header Name</th><th>Header Value</th></tr></thead><tbody><tr><td>1</td><td>:authority</td><td></td></tr><tr><td>2</td><td>:method</td><td>GET</td></tr><tr><td>3</td><td>:method</td><td>POST</td></tr><tr><td>4</td><td>:path</td><td>/</td></tr><tr><td>5</td><td>:path</td><td>/index.html</td></tr><tr><td>6</td><td>:scheme</td><td>http</td></tr><tr><td>7</td><td>:scheme</td><td>https</td></tr><tr><td>8</td><td>:status</td><td>200</td></tr><tr><td>…</td><td>…</td><td>…</td></tr><tr><td>32</td><td>cookie</td><td></td></tr><tr><td>…</td><td>…</td><td>…</td></tr><tr><td>60</td><td>via</td><td></td></tr><tr><td>61</td><td>www</td><td>-authenticate</td></tr></tbody></table><p>同时, 浏览器可以告知服务端, 将<code>cookie: xxx</code>添加到动态字典中, 这样后续整个键值对就可以使用一个字段表示了. 类似的, 服务端也可以更新对方的动态字典. 需要注意的是, 动态字典是上下文有关的, 需要为每个HTTP/2连接维护不同的字典.</p><p>使用字典可以极大的提升压缩效果, 其中静态字典在首次请求中就可以使用. 对于静态, 动态字典不存在的内容, 还可以使用哈夫曼编码来减小体积. HTTP/2使用了一份静态哈夫曼码表, 也需要内置在客户端和服务端之中.</p><p>此外，HTTP/1 的状态行信息（Method、Path、Status 等），在 HTTP/2 中被拆成键值对放入头部（冒号开头的那些），同样可以享受到字典和哈夫曼压缩。另外，<strong>HTTP/2 中所有头部名称必须小写</strong>。</p><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="服务端推送">服务端推送<a class="hash-link" href="#服务端推送" title="标题的直接链接">​</a></h2><p>在 HTTP 2.0 中，服务端可以在客户端某个请求后，主动推送其他资源。</p><p><img loading="lazy" alt="image" src="/assets/images/20210124162115517-82303e1f86fec67b10e81baa08d5958f.png" width="866" height="352" class="img_wb0S"></p><p>可以想象以下情况，某些资源客户端是一定会请求的，这时就可以采取服务端 push 的技术，提前给客户端推送必要的资源，这样就可以相对减少一点延迟时间。当然在浏览器兼容的情况下你也可以使用<code>prefetch</code>。</p><p>服务端推送还有一个比较大的优势: 可以缓存. 也就是说可以在遵循同源策略的情况下, 不同页面之间共享缓存资源.</p><p>注意, 服务端推送有两点:</p><ol><li>推送是遵循同源策略的</li><li>这种服务端的推送是基于客户端的请求响应来决定的.</li></ol><p>当服务端需要主动推送某个资源的时候, 就会发送一个<code>Frame Type</code>为<code>PUSH_PROMISE</code>的<code>Frame</code>, 里面携带了PUSH需要新建的Stream ID. 意思是告诉客户端: 接下来我要用这个ID给你发送信息. 客户端解析Frame的时候, 发现它是一个PUSH_PROMISE类型, 就会接受服务端要推送的流.</p><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="性能瓶颈">性能瓶颈<a class="hash-link" href="#性能瓶颈" title="标题的直接链接">​</a></h2><p>启用HTTP/2会带来很大的性能提升, 但是也会带来新的性能瓶颈. 因为现在所有的压力都集中在底层一个TCP的连接上, TCP很可能就是下一个性能瓶颈, 比如TCP分组的队首阻塞问题, 单个TCP packet丢失导致的整个连接阻塞, 无法避免, 此时所有消息都会受到印象. </p><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="nginx-升级-http2">nginx 升级 HTTP2<a class="hash-link" href="#nginx-升级-http2" title="标题的直接链接">​</a></h2><ol><li>nginx版本高于1,9,5</li><li>安装了<code>--with-http_ssl_module</code>和<code>--with-http_v2_module</code></li><li>配置了HTTPS(启用HTTP2的前提条件)</li><li>配置<code>listen 443 ssl http2</code></li><li><code>nginx restart</code>(注意不要直接<code>nginx -s reload</code>)</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_rm2F" id="参考链接">参考链接<a class="hash-link" href="#参考链接" title="标题的直接链接">​</a></h2><ul><li><a href="https://www.zhihu.com/question/34074946/answer/75364178" target="_blank" rel="noopener noreferrer">知乎-HTTP/2.0 相比 1.0 有哪些重大改进？</a></li><li><a href="https://blog.csdn.net/qq_32523587/article/details/79970471" target="_blank" rel="noopener noreferrer">HTTP/2 头部压缩技术介绍</a></li><li><a href="https://blog.csdn.net/lpq1201/article/details/113092261" target="_blank" rel="noopener noreferrer">HTTP2</a></li><li><a href="https://zhuanlan.zhihu.com/p/89471776" target="_blank" rel="noopener noreferrer">深入理解http2.0协议，看这篇就够了！</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/计算机网络/HTTP/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">HTTP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/计算机网络/HTTP/HTTP3"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">HTTP3</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_a_w_ thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#多路复用" class="table-of-contents__link toc-highlight">多路复用</a></li><li><a href="#二进制分帧" class="table-of-contents__link toc-highlight">二进制分帧</a></li><li><a href="#请求优先级" class="table-of-contents__link toc-highlight">请求优先级</a></li><li><a href="#首部压缩" class="table-of-contents__link toc-highlight">首部压缩</a><ul><li><a href="#为什么要压缩" class="table-of-contents__link toc-highlight">为什么要压缩</a></li><li><a href="#技术原理" class="table-of-contents__link toc-highlight">技术原理</a></li></ul></li><li><a href="#服务端推送" class="table-of-contents__link toc-highlight">服务端推送</a></li><li><a href="#性能瓶颈" class="table-of-contents__link toc-highlight">性能瓶颈</a></li><li><a href="#nginx-升级-http2" class="table-of-contents__link toc-highlight">nginx 升级 HTTP2</a></li><li><a href="#参考链接" class="table-of-contents__link toc-highlight">参考链接</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Wiki doc, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5d46ccd1.js"></script>
<script src="/assets/js/main.a052ef5d.js"></script>
</body>
</html>