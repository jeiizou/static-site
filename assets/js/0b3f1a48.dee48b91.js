"use strict";(self.webpackChunkwiki_site=self.webpackChunkwiki_site||[]).push([[9756],{50158:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>k});var a=t(46393);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var o=a.createContext({}),d=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},s=function(e){var n=d(e.components);return a.createElement(o.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},y=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),y=d(t),k=r,m=y["".concat(o,".").concat(k)]||y[k]||u[k]||l;return t?a.createElement(m,i(i({ref:n},s),{},{components:t})):a.createElement(m,i({ref:n},s))}));function k(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,i=new Array(l);i[0]=y;var p={};for(var o in n)hasOwnProperty.call(n,o)&&(p[o]=n[o]);p.originalType=e,p.mdxType="string"==typeof e?e:r,i[1]=p;for(var d=2;d<l;d++)i[d]=t[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}y.displayName="MDXCreateElement"},37785:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>p,toc:()=>d});var a=t(39421),r=(t(46393),t(50158));const l={},i="\u8bed\u6cd5\u7279\u6027-ArrayBuffer",p={unversionedId:"\u524d\u7aef\u57fa\u7840/JavsScript/1-4-\u8bed\u6cd5\u7279\u6027-ArrayBuffer",id:"\u524d\u7aef\u57fa\u7840/JavsScript/1-4-\u8bed\u6cd5\u7279\u6027-ArrayBuffer",title:"\u8bed\u6cd5\u7279\u6027-ArrayBuffer",description:"\u539f\u6587\u94fe\u63a5: \u962e\u4e00\u5cf0\u7684 ES6 \u5165\u95e8",source:"@site/docs/01-\u524d\u7aef\u57fa\u7840/01-JavsScript/1-4-\u8bed\u6cd5\u7279\u6027-ArrayBuffer.md",sourceDirName:"01-\u524d\u7aef\u57fa\u7840/01-JavsScript",slug:"/\u524d\u7aef\u57fa\u7840/JavsScript/1-4-\u8bed\u6cd5\u7279\u6027-ArrayBuffer",permalink:"/docs/\u524d\u7aef\u57fa\u7840/JavsScript/1-4-\u8bed\u6cd5\u7279\u6027-ArrayBuffer",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u8bed\u6cd5\u7279\u6027-Symbol",permalink:"/docs/\u524d\u7aef\u57fa\u7840/JavsScript/1-3-\u8bed\u6cd5\u7279\u6027-Symbol"},next:{title:"\u8bed\u6cd5\u7279\u6027-WebWorker",permalink:"/docs/\u524d\u7aef\u57fa\u7840/JavsScript/1-5-\u8bed\u6cd5\u7279\u6027-WebWorker"}},o={},d=[{value:"1. \u4f7f\u7528",id:"1-\u4f7f\u7528",level:2},{value:"2. \u5b57\u8282\u5e8f",id:"2-\u5b57\u8282\u5e8f",level:2},{value:"2.1 BYTES_PER_ELEMENT",id:"21-bytes_per_element",level:3},{value:"3. \u6ea2\u51fa",id:"3-\u6ea2\u51fa",level:2},{value:"4. ArrayBuffer \u65b9\u6cd5",id:"4-arraybuffer-\u65b9\u6cd5",level:2},{value:"4.1 ArrayBuffer.prototype.byteLength",id:"41-arraybufferprototypebytelength",level:3},{value:"4.2 ArrayBuffer.prototype.slice()",id:"42-arraybufferprototypeslice",level:3},{value:"4.3 ArrayBuffer.isView()",id:"43-arraybufferisview",level:3},{value:"5. ArrayBuffer &lt;--&gt; string",id:"5-arraybuffer----string",level:2},{value:"6. TypedArray \u89c6\u56fe",id:"6-typedarray-\u89c6\u56fe",level:2},{value:"6.1 \u6784\u9020 TypedArray",id:"61-\u6784\u9020-typedarray",level:3},{value:"6.2TypedArray \u65b9\u6cd5",id:"62typedarray-\u65b9\u6cd5",level:3},{value:"6.2.1 TypedArray.prototype.buffer",id:"621-typedarrayprototypebuffer",level:4},{value:"6.2.2 TypedArray.prototype.byteLength\uff0cTypedArray.prototype.byteOffset",id:"622-typedarrayprototypebytelengthtypedarrayprototypebyteoffset",level:4},{value:"6.2.3 TypedArray.prototype.length",id:"623-typedarrayprototypelength",level:4},{value:"6.2.4 TypedArray.prototype.set()",id:"624-typedarrayprototypeset",level:4},{value:"6.2.5 TypedArray.prototype.subarray()",id:"625-typedarrayprototypesubarray",level:4},{value:"6.2.6 TypedArray.prototype.slice()",id:"626-typedarrayprototypeslice",level:4},{value:"6.2.7 TypedArray.of()",id:"627-typedarrayof",level:4},{value:"6.2.8 TypedArray.from()",id:"628-typedarrayfrom",level:4},{value:"7. \u590d\u5408\u89c6\u56fe",id:"7-\u590d\u5408\u89c6\u56fe",level:2},{value:"8. DataView \u89c6\u56fe",id:"8-dataview-\u89c6\u56fe",level:2},{value:"9. ArrayBuffer \u7684\u5e94\u7528",id:"9-arraybuffer-\u7684\u5e94\u7528",level:2},{value:"9.1 Ajax",id:"91-ajax",level:3},{value:"9.2 Canvas",id:"92-canvas",level:3},{value:"9.3 WebSocket",id:"93-websocket",level:3},{value:"9.4 Fetch Api",id:"94-fetch-api",level:3},{value:"9.5 File Api",id:"95-file-api",level:3},{value:"9.6 SharedArrayBuffer",id:"96-sharedarraybuffer",level:3},{value:"9.7. Atomic \u5bf9\u8c61",id:"97-atomic-\u5bf9\u8c61",level:3},{value:"9.7.1 Atomics.store()\uff0cAtomics.load()",id:"971-atomicsstoreatomicsload",level:4},{value:"9.7.2 Atomics.exchange()",id:"972-atomicsexchange",level:4},{value:"9.7.3 Atomics.wait()\uff0cAtomics.wake()",id:"973-atomicswaitatomicswake",level:4},{value:"9.7.4 \u8fd0\u7b97\u65b9\u6cd5: add, sub, and, or, xor",id:"974-\u8fd0\u7b97\u65b9\u6cd5-add-sub-and-or-xor",level:4},{value:"9.7.5 \u5176\u4ed6\u65b9\u6cd5",id:"975-\u5176\u4ed6\u65b9\u6cd5",level:4}],s={toc:d};function u(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u8bed\u6cd5\u7279\u6027-arraybuffer"},"\u8bed\u6cd5\u7279\u6027-ArrayBuffer"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"http://es6.ruanyifeng.com/#docs/arraybuffer"},"\u539f\u6587\u94fe\u63a5: \u962e\u4e00\u5cf0\u7684 ES6 \u5165\u95e8"))),(0,r.kt)("p",null,"ArrayBuffer \u662f\u5f88\u65e9\u5c31\u5b58\u5728\u4e00\u79cd\u6570\u636e\u63a5\u53e3, ES6 \u5f00\u59cb\u5c06\u5176\u6b63\u5f0f\u7eb3\u5165 ECMAScript \u89c4\u683c. \u7528\u4e8e\u5904\u7406\u4e8c\u8fdb\u5236\u7684\u6570\u636e."),(0,r.kt)("p",null,"\u4e8c\u8fdb\u5236\u6570\u636e\u6709\u4e09\u7c7b\u5bf9\u8c61:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"ArrayBuffer"),'\u5bf9\u8c61: \u4ee3\u8868\u5185\u5b58\u4e2d\u7684\u4e00\u6bb5\u4e8c\u8fdb\u5236\u6570\u636e, \u53ef\u4ee5\u901a\u8fc7"\u89c6\u56fe"\u8fdb\u884c\u64cd\u4f5c, "\u89c6\u56fe"\u90e8\u7f72\u4e86\u6570\u7ec4\u63a5\u53e3, \u6240\u4ee5\u53ef\u4ee5\u7528\u6570\u7ec4\u7684\u65b9\u6cd5\u6765\u64cd\u4f5c\u5185\u5b58.'),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"TypedArray"),"\u89c6\u56fe: \u5305\u542b\u4e86 9 \u79cd\u7c7b\u578b\u7684\u89c6\u56fe, ",(0,r.kt)("inlineCode",{parentName:"li"},"Uint8Array"),"(\u65e0\u7b26\u53f7 8 \u4f4d\u6574\u6570), ",(0,r.kt)("inlineCode",{parentName:"li"},"int16Array"),"(16 \u4f4d\u6570\u7ec4\u63a5\u53e3),",(0,r.kt)("inlineCode",{parentName:"li"},"Float32Array"),"(32 \u4f4d\u6d6e\u70b9\u6570)\u7b49\u7b49"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"DataView"),"\u89c6\u56fe: \u53ef\u4ee5\u81ea\u5b9a\u4e49\u7b26\u5408\u683c\u5f0f\u7684\u89c6\u56fe. \u6bd4\u5982\u7b2c\u4e00\u4e2a\u5b57\u8282\u662f",(0,r.kt)("inlineCode",{parentName:"li"},"Unit8"),", \u7b2c\u4e8c, \u4e09\u4e2a\u5b57\u8282\u662f",(0,r.kt)("inlineCode",{parentName:"li"},"Int16"),",\u7b49\u7b49, \u6b64\u5916\u8fd8\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5b57\u8282\u5e8f.")),(0,r.kt)("h2",{id:"1-\u4f7f\u7528"},"1. \u4f7f\u7528"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u4e0d\u80fd\u76f4\u63a5\u8bfb\u5199, \u53ea\u80fd\u901a\u8fc7\u89c6\u56fe\u6765\u8bfb\u5199, \u89c6\u56fe\u7684\u4f5c\u7528\u5c31\u662f\u4ee5\u6307\u5b9a\u7684\u683c\u5f0f\u6765\u89e3\u8bfb\u4e8c\u8fdb\u5236\u6570\u636e."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"//\u521b\u5efa\u4e00\u6bb532\u5b57\u8282\u7684\u5185\u5b58\u533a\u57df, \u6bcf\u4e2a\u5b57\u8282\u7684\u503c\u9ed8\u8ba4\u4e3a0\nconst buf = new ArrayBuffer(32);\n//\u521b\u5efaDataView\u89c6\u56fe, \u4ee5\u65e0\u7b26\u53f78\u4f4d\u6574\u6570\u4ece\u5077\u6e21\u53bb8\u4f4d\u4e8c\u8fdb\u5236\u6570\u636e, \u7ed3\u679c\u5f97\u52300.\nconst dataView = new DataView(buf);\ndataView.getUint8(0); // 0\n")),(0,r.kt)("p",null,"\u53e6\u4e00\u79cd\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"TypeArray"),"\u89c6\u56fe, \u4e0e",(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u89c6\u56fe\u7684\u4e00\u4e2a\u533a\u522b\u662f, \u5b83\u4e0d\u662f\u4e00\u4e2a\u6784\u9020\u51fd\u6570, \u800c\u662f\u4e00\u7ec4\u6784\u9020\u51fd\u6570, \u4ee3\u8868\u4e0d\u540c\u7684\u6570\u636e\u683c\u5f0f:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new ArrayBuffer(12);\n//32\u4f4d\u6709\u7b26\u53f7\u6574\u6570\u7c7b\u578b\nconst x1 = new Int32Array(buffer);\nx1[0] = 1;\n//8\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\nconst x2 = new Uint8Array(buffer);\nx2[0] = 2;\n\nx1[0]; // 2\n")),(0,r.kt)("p",null,"\u4e24\u4e2a\u89c6\u56fe\u5bf9\u5e94\u7684\u662f\u540c\u4e00\u6bb5\u5185\u5b58, \u4e00\u4e2a\u89c6\u56fe\u4fee\u6539\u5e95\u5c42\u5185\u5b58, \u4f1a\u5f71\u54cd\u53e6\u4e00\u4e2a\u89c6\u56fe."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u89c6\u56fe\u7684\u6784\u9020\u51fd\u6570, \u9664\u4e86\u63a5\u53d7",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5b9e\u4f8b, \u8fd8\u53ef\u4ee5\u63a5\u53d7\u666e\u901a\u6570\u7ec4, \u76f4\u63a5\u5206\u914d\u5185\u5b58\u751f\u6210\u5e95\u5c42\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5b9e\u4f8b, \u5e76\u540c\u65f6\u8d4b\u503c:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const typedArray = new Uint8Array([0, 1, 2]);\ntypedArray.length; // 3\n\ntypedArray[0] = 5;\ntypedArray; // [5, 1, 2]\n")),(0,r.kt)("h2",{id:"2-\u5b57\u8282\u5e8f"},"2. \u5b57\u8282\u5e8f"),(0,r.kt)("p",null,"\u5b57\u8282\u5e8f\u6307\u7684\u662f\u6570\u503c\u5728\u5185\u5b58\u4e2d\u7684\u8868\u793a\u65b9\u5f0f."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new ArrayBuffer(16);\nconst int32View = new Int32Array(buffer);\n\nfor (let i = 0; i < int32View.length; i++) {\n    int32View[i] = i * 2;\n}\n")),(0,r.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u6709 16 \u4e2a\u5b57\u8282, \u5728\u4ed6\u7684\u57fa\u7840\u4e0a, \u5efa\u7acb\u4e86\u4e00\u4e2a 32 \u4f4d\u6574\u6570\u7684\u89c6\u56fe, \u6bcf\u4e2a 32 \u4f4d\u7684\u6574\u6570\u5360\u636e 4 \u4e2a\u5b57\u8282, \u6240\u4ee5\u53ef\u4ee5\u5199\u5165 4 \u4e2a\u6574\u6570, \u4f9d\u6b21\u4e3a 0,2,4,6."),(0,r.kt)("p",null,"\u5982\u679c\u5728\u8fd9\u6bb5\u6570\u636e\u4e0a\u5efa\u7acb\u4e00\u4e2a 16 \u4f4d\u6574\u6570, \u5219\u8bfb\u53d6\u7684\u7ed3\u679c\u4f1a\u5b8c\u5168\u4e0d\u540c:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const int16View = new Int16Array(buffer);\n\nfor (let i = 0; i < int16View.length; i++) {\n    console.log('Entry ' + i + ': ' + int16View[i]);\n}\n// Entry 0: 0\n// Entry 1: 0\n// Entry 2: 2\n// Entry 3: 0\n// Entry 4: 4\n// Entry 5: 0\n// Entry 6: 6\n// Entry 7: 0\n")),(0,r.kt)("p",null,"\u7531\u4e8e\u6bcf\u4e2a 16 \u4f4d\u6574\u6570\u5360\u636e 2 \u4e2a\u5b57\u8282, \u6240\u4ee5\u6574\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u73b0\u5728\u88ab\u5206\u6210\u4e86 8 \u6bb5\u5417\u7136\u540e\u7531\u4e8e x86 \u4f53\u7cfb\u7684\u8ba1\u7b97\u673a\u90fd\u91c7\u7528\u5c0f\u7aef\u5b57\u8282\u5e8f, \u6743\u91cd\u9ad8\u7684\u5b57\u8282\u6392\u5728\u5176\u540e\u9762\u7684\u5185\u5b58, \u6743\u91cd\u8f7b\u7684\u5b57\u8282\u6392\u5728\u524d\u9762\u7684\u5185\u5b58\u5730\u5740, \u6240\u4ee5\u5c31\u5f97\u5230\u4e86\u4e0a\u9762\u7684\u7ed3\u679c."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u89c6\u56fe\u53ef\u4ee5\u8bbe\u5b9a\u5b57\u8282\u5e8f. \u4e3a\u4e00\u4e9b\u5927\u7aef\u5b57\u8282\u5e8f\u7684\u8bbe\u5907\u548c\u7cfb\u7edf\u4f5c\u51fa\u8c03\u6574."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u5047\u5b9a\u67d0\u6bb5buffer\u5305\u542b\u5982\u4e0b\u5b57\u8282 [0x02, 0x01, 0x03, 0x07]\nconst buffer = new ArrayBuffer(4);\nconst v1 = new Uint8Array(buffer);\nv1[0] = 2;\nv1[1] = 1;\nv1[2] = 3;\nv1[3] = 7;\n\nconst uInt16View = new Uint16Array(buffer);\n\n// \u8ba1\u7b97\u673a\u91c7\u7528\u5c0f\u7aef\u5b57\u8282\u5e8f\n// \u6240\u4ee5\u5934\u4e24\u4e2a\u5b57\u8282\u7b49\u4e8e258\nif (uInt16View[0] === 258) {\n    console.log('OK'); // \"OK\"\n}\n\n// \u8d4b\u503c\u8fd0\u7b97\nuInt16View[0] = 255; // \u5b57\u8282\u53d8\u4e3a[0xFF, 0x00, 0x03, 0x07]\nuInt16View[0] = 0xff05; // \u5b57\u8282\u53d8\u4e3a[0x05, 0xFF, 0x03, 0x07]\nuInt16View[1] = 0x0210; // \u5b57\u8282\u53d8\u4e3a[0x05, 0xFF, 0x10, 0x02]\n")),(0,r.kt)("p",null,"\u4e0b\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u5224\u65ad\u5f53\u524d\u7684\u89c6\u56fe\u662f\u5c0f\u7aef\u5b57\u8282\u5e8f\u8fd8\u662f\u5927\u7aef\u5b57\u8282\u5e8f:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const BIG_ENDIAN = Symbol('BIG_ENDIAN');\nconst LITTLE_ENDIAN = Symbol('LITTLE_ENDIAN');\n\nfunction getPlatformEndianness() {\n    let arr32 = Uint32Array.of(0x12345678);\n    let arr8 = new Uint8Array(arr32.buffer);\n    switch (arr8[0] * 0x1000000 + arr8[1] * 0x10000 + arr8[2] * 0x100 + arr8[3]) {\n        case 0x12345678:\n            return BIG_ENDIAN;\n        case 0x78563412:\n            return LITTLE_ENDIAN;\n        default:\n            throw new Error('Unknown endianness');\n    }\n}\n")),(0,r.kt)("h3",{id:"21-bytes_per_element"},"2.1 BYTES_PER_ELEMENT"),(0,r.kt)("p",null,"\u8be5\u5c5e\u6027\u53ef\u4ee5\u8868\u793a\u8fd9\u79cd\u6570\u636e\u7c7b\u578b\u5360\u636e\u7684\u5b57\u8282\u6570:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Int8Array.BYTES_PER_ELEMENT; // 1\nUint8Array.BYTES_PER_ELEMENT; // 1\nUint8ClampedArray.BYTES_PER_ELEMENT; // 1\nInt16Array.BYTES_PER_ELEMENT; // 2\nUint16Array.BYTES_PER_ELEMENT; // 2\nInt32Array.BYTES_PER_ELEMENT; // 4\nUint32Array.BYTES_PER_ELEMENT; // 4\nFloat32Array.BYTES_PER_ELEMENT; // 4\nFloat64Array.BYTES_PER_ELEMENT; // 8\n")),(0,r.kt)("p",null,"\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u4e2d\u83b7\u53d6\u5230:",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray.prototype.BYTES_PER_ELEMENT")),(0,r.kt)("h2",{id:"3-\u6ea2\u51fa"},"3. \u6ea2\u51fa"),(0,r.kt)("p",null,"\u4e0d\u540c\u7684\u89c6\u56fe\u7c7b\u578b, \u5185\u5b58\u7a7a\u95f4\u662f\u786e\u5b9a\u7684. \u8d85\u51fa\u8303\u56f4\u7684\u6570\u636e\u5c31\u4f1a\u51fa\u73b0\u6ea2\u51fa. \u6bd4\u5982, 8 \u4f4d\u89c6\u56fe\u5c31\u53ea\u80fd\u5bb9\u7eb3\u4e00\u4e2a 8 \u4f4d\u7684\u4e8c\u8fdb\u5236\u503c, \u5982\u679c\u653e\u5165\u4e00\u4e2a 9 \u4f4d\u7684\u503c, \u5c31\u4f1a\u6ea2\u51fa. ",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6570\u7ec4\u7684\u6ea2\u51fa\u5904\u7406\u89c4\u5219, \u7b80\u5355\u6765\u8bf4, \u5c31\u662f\u629b\u5f03\u6ea2\u51fa\u7684\u4f4d, \u7136\u540e\u6309\u7167\u89c6\u56fe\u7c7b\u578b\u8fdb\u884c\u89e3\u91ca."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const uint8 = new Uint8Array(1);\n\nuint8[0] = 256;\nuint8[0]; // 0\n\nuint8[0] = -1;\nuint8[0]; // 255\n")),(0,r.kt)("p",null,'\u8d1f\u6570\u5728\u8ba1\u7b97\u673a\u5185\u90e8\u5728\u7528"2 \u7684\u8865\u7801"\u8868\u793a, \u5c06\u5bf9\u5e94\u7684\u6574\u6570\u503c\u8fdb\u884c\u5426\u8fd0\u7b97, \u7136\u540e\u52a0 1, \u6bd4\u5982',(0,r.kt)("inlineCode",{parentName:"p"},"-1"),"\u5bf9\u5e94\u7684\u6b63\u503c\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"1"),", \u8fdb\u884c\u5426\u8fd0\u7b97, \u5f97\u5230",(0,r.kt)("inlineCode",{parentName:"p"},"11111110"),", \u518d\u52a0\u4e0a",(0,r.kt)("inlineCode",{parentName:"p"},"1"),"\u5c31\u662f\u8865\u7801\u5f62\u5f0f:",(0,r.kt)("inlineCode",{parentName:"p"},"11111111"),". ",(0,r.kt)("inlineCode",{parentName:"p"},"unit8"),"\u6309\u7167\u65e0\u7b26\u53f7\u7684 8 \u4f4d\u6574\u6570\u89e3\u91ca",(0,r.kt)("inlineCode",{parentName:"p"},"11111111"),", \u8fd4\u56de\u7ed3\u679c\u5c31\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"255"),"."),(0,r.kt)("p",null,"\u4e00\u4e2a\u7b80\u5355\u7684\u8f6c\u6362\u89c4\u5219, \u53ef\u4ee5\u8fd9\u6837\u8868\u793a:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6b63\u5411\u6ea2\u51fa(overflow): \u5f53\u8f93\u5165\u503c\u5927\u4e8e\u5f53\u524d\u6570\u636e\u7c7b\u578b\u7684\u6700\u5927\u503c, \u7ed3\u679c\u7b49\u4e8e\u5f53\u524d\u6570\u636e\u7c7b\u578b\u7684\u6700\u5c0f\u503c\u52a0\u4e0a\u4f59\u503c, \u518d\u51cf\u53bb 1."),(0,r.kt)("li",{parentName:"ul"},"\u8d1f\u5411\u6ea2\u51fa(underflow): \u5f53\u8f93\u5165\u503c\u5c0f\u4e8e\u5f53\u524d\u6570\u636e\u7c7b\u578b\u7684\u6700\u5c0f\u503c, \u7ed3\u679c\u7b49\u4e8e\u5f53\u524d\u6570\u636e\u7c7b\u578b\u7684\u6700\u5927\u503c\u51cf\u53bb\u4f59\u503c\u7684\u7edd\u5bf9\u503c, \u518d\u52a0\u4e0a 1.")),(0,r.kt)("p",null,"(\u4f59\u503c\u6307\u7684\u662f\u53d6\u6a21\u8fd0\u7b97\u7684\u7ed3\u679c)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const int8 = new Int8Array(1);\n\nint8[0] = 128;\nint8[0]; // -128 (-128+(128%127)-1)\n\nint8[0] = -129;\nint8[0]; // 127 (127-(128%127)+1)\n")),(0,r.kt)("p",null,"\u6bd4\u8f83\u7279\u6b8a\u7684\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8ClampedArray"),"\u89c6\u56fe\u7684\u6ea2\u51fa\u89c4\u5219, \u5b83\u89c4\u5b9a\u51e1\u662f\u53d1\u751f\u6b63\u5411\u6ea2\u51fa, \u8be5\u503c\u4e00\u5f8b\u7b49\u4e8e\u5f53\u524d\u6570\u636e\u7c7b\u578b\u7684\u6700\u5927\u503c(255), \u5982\u679c\u53d1\u751f\u8d1f\u5411\u6ea2\u51fa, \u8be5\u503c\u4e00\u5f8b\u7b49\u4e8e\u5f53\u524d\u6570\u636e\u7c7b\u578b\u7684\u6700\u5c0f\u503c(0)."),(0,r.kt)("h2",{id:"4-arraybuffer-\u65b9\u6cd5"},"4. ArrayBuffer \u65b9\u6cd5"),(0,r.kt)("h3",{id:"41-arraybufferprototypebytelength"},"4.1 ArrayBuffer.prototype.byteLength"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5b9e\u4f8b\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"byteLength"),"\u5c5e\u6027, \u8fd4\u56de\u6240\u5206\u914d\u5185\u5b58\u533a\u57df\u7684\u81ea\u8282\u957f\u5ea6."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new ArrayBuffer(32);\nbuffer.byteLength;\n// 32\n")),(0,r.kt)("p",null,"\u5982\u679c\u8981\u4e30\u7891\u7684\u5185\u5b58\u533a\u57df\u5f88\u5927, \u662f\u6709\u53ef\u80fd\u5206\u914d\u5931\u8d25\u7684(\u6ca1\u6709\u90a3\u4e48\u591a\u7684\u8fde\u7eed\u7a7a\u4f59\u5185\u5b58), \u6240\u4ee5\u6709\u5fc5\u8981\u68c0\u67e5\u662f\u5426\u5206\u914d\u6210\u529f."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"if (buffer.byteLength === n) {\n    // \u6210\u529f\n} else {\n    // \u5931\u8d25\n}\n")),(0,r.kt)("h3",{id:"42-arraybufferprototypeslice"},"4.2 ArrayBuffer.prototype.slice()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5b9e\u4f8b\u6709\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"slice"),"\u65b9\u6cd5, \u5141\u8bb8\u5c06\u5185\u5b58\u533a\u57df\u7684\u4e00\u90e8\u5206, \u62f7\u8d1d\u751f\u6210\u4e00\u4e2a\u65b0\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5bf9\u8c61."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new ArrayBuffer(8);\nconst newBuffer = buffer.slice(0, 3);\n")),(0,r.kt)("p",null,"\u9664\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"slice"),"\u65b9\u6cd5, ",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u4e0d\u63d0\u4f9b\u4efb\u4f55\u76f4\u63a5\u8bfb\u5199\u5185\u5b58\u7684\u65b9\u6cd5, \u53ea\u5141\u8bb8\u5728\u5176\u4e0a\u65b9\u5efa\u7acb\u89c6\u56fe, \u7136\u540e\u901a\u8fc7\u89c6\u56fe\u8bfb\u5199."),(0,r.kt)("h3",{id:"43-arraybufferisview"},"4.3 ArrayBuffer.isView()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"isView"),"\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c, \u8868\u793a\u53c2\u6570\u662f\u5426\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u7684\u89c6\u56fe\u5b9e\u4f8b, \u8fd9\u4e2a\u65b9\u6cd5\u5927\u81f4\u76f8\u5f53\u4e8e\u5224\u65ad\u53c2\u6570\u662f\u5426\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u5b9e\u4f8b\u6216",(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u5b9e\u4f8b:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new ArrayBuffer(8);\nArrayBuffer.isView(buffer); // false\n\nconst v = new Int32Array(buffer);\nArrayBuffer.isView(v); // true\n")),(0,r.kt)("h2",{id:"5-arraybuffer----string"},"5. ArrayBuffer <--\x3e string"),(0,r.kt)("p",null,"\u4e3b\u8981\u4f7f\u7528\u7684\u662f\u539f\u751f\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"TextEncoder"),"\u548c",(0,r.kt)("inlineCode",{parentName:"p"},"TextDecoder"),"\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"/**\n * Convert ArrayBuffer/TypedArray to String via TextDecoder\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/TextDecoder\n */\nfunction ab2str(\n    input: ArrayBuffer | Uint8Array | Int8Array | Uint16Array | Int16Array | Uint32Array | Int32Array,\n    outputEncoding: string = 'utf8'\n): string {\n    const decoder = new TextDecoder(outputEncoding);\n    return decoder.decode(input);\n}\n\n/**\n * Convert String to ArrayBuffer via TextEncoder\n *\n * @see https://developer.mozilla.org/zh-CN/docs/Web/API/TextEncoder\n */\nfunction str2ab(input: string): ArrayBuffer {\n    const view = str2Uint8Array(input);\n    return view.buffer;\n}\n\n/** Convert String to Uint8Array */\nfunction str2Uint8Array(input: string): Uint8Array {\n    const encoder = new TextEncoder();\n    const view = encoder.encode(input);\n    return view;\n}\n")),(0,r.kt)("h2",{id:"6-typedarray-\u89c6\u56fe"},"6. TypedArray \u89c6\u56fe"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u4f5c\u4e3a\u5185\u5b58\u533a\u57df, \u53ef\u4ee5\u5b58\u653e\u591a\u79cd\u7c7b\u578b\u7684\u6570\u636e, \u540c\u4e00\u6bb5\u5185\u5b58, \u4e0d\u540c\u6570\u636e\u6709\u4e0d\u540c\u7684\u89e3\u6bd2\u65b9\u5f0f, \u8fd9\u5c31\u53eb\u505a\u89c6\u56fe. ",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u6709\u4e24\u79cd\u89c6\u56fe, \u4e00\u79cd\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u89c6\u56fe, \u53e6\u4e00\u79cd\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u89c6\u56fe. \u524d\u8005\u7684\u6570\u7ec4\u6210\u5458\u90fd\u662f\u540c\u4e00\u4e2a\u6570\u636e\u7c7b\u578b, \u540e\u8005\u7684\u6570\u7ec4\u6210\u5458\u53ef\u4ee5\u4f7f\u4e0d\u540c\u7684\u6570\u636e\u7c7b\u578b."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6709 9 \u79cd\u7c7b\u578b, \u6bcf\u4e00\u79cd\u89c6\u56fe\u90fd\u662f\u4e00\u79cd\u6784\u9020\u51fd\u6570:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Int8Array"),": 8 \u4f4d\u6709\u7b26\u53f7\u6574\u6570\uff0c\u957f\u5ea6 1 \u4e2a\u5b57\u8282\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Uint8Array"),": 8 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u957f\u5ea6 1 \u4e2a\u5b57\u8282\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Uint8ClampedArray"),": 8 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u957f\u5ea6 1 \u4e2a\u5b57\u8282\uff0c\u6ea2\u51fa\u5904\u7406\u4e0d\u540c\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Int16Array"),": 16 \u4f4d\u6709\u7b26\u53f7\u6574\u6570\uff0c\u957f\u5ea6 2 \u4e2a\u5b57\u8282\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Uint16Array"),": 16 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u957f\u5ea6 2 \u4e2a\u5b57\u8282\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Int32Array"),": 32 \u4f4d\u6709\u7b26\u53f7\u6574\u6570\uff0c\u957f\u5ea6 4 \u4e2a\u5b57\u8282\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Uint32Array"),": 32 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u957f\u5ea6 4 \u4e2a\u5b57\u8282\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Float32Array"),": 32 \u4f4d\u6d6e\u70b9\u6570\uff0c\u957f\u5ea6 4 \u4e2a\u5b57\u8282\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Float64Array"),": 64 \u4f4d\u6d6e\u70b9\u6570\uff0c\u957f\u5ea6 8 \u4e2a\u5b57\u8282\u3002")),(0,r.kt)("p",null,"\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"TypeArray"),"\u89c6\u56fe\u4e0a\u6240\u6709\u7684\u6570\u7ec4\u65b9\u6cd5\u5728\u5b83\u4e0a\u9762\u90fd\u80fd\u4f7f\u7528. \u666e\u901a\u6570\u7ec4\u4e0e TypedArray \u6570\u7ec4\u7684\u5dee\u5f02\u4e3b\u8981\u6709\u4ee5\u4e0b\u51e0\u70b9:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"TypedArray \u6570\u7ec4\u7684\u6240\u6709\u6210\u5458\u90fd\u662f\u540c\u4e00\u7c7b\u578b"),(0,r.kt)("li",{parentName:"ul"},"TypedArray \u6570\u7ec4\u7684\u6210\u5458\u662f\u8fde\u7eed\u7684, \u4e0d\u4f1a\u6709\u7a7a\u4f4d"),(0,r.kt)("li",{parentName:"ul"},"TypedArray \u6570\u7ec4\u7684\u6210\u5458\u9ed8\u8ba4\u503c\u4e3a 0."),(0,r.kt)("li",{parentName:"ul"},"TypedArray \u672c\u8d28\u53ea\u662f\u4e00\u4e2a\u89c6\u56fe, \u672c\u8eab\u4e0d\u5b58\u50a8\u6570\u636e, \u6570\u636e\u90fd\u5b58\u50a8\u5728\u5e95\u5c42\u7684",(0,r.kt)("inlineCode",{parentName:"li"},"ArrayBuffer"),"\u4e2d.")),(0,r.kt)("h3",{id:"61-\u6784\u9020-typedarray"},"6.1 \u6784\u9020 TypedArray"),(0,r.kt)("p",null,"\u6784\u9020",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6709 9 \u4e2d\u6784\u9020\u51fd\u6570, \u7528\u6765\u751f\u6210\u54cd\u5e94\u7c7b\u578b\u7684\u6570\u7ec4\u5b9e\u4f8b."),(0,r.kt)("p",null,"\u6784\u9020\u51fd\u6570\u6709\u56db\u79cd\u7528\u6cd5(?:\u53ef\u9009),=:\u9ed8\u8ba4:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"TypedArray(buffer, bytedOffset?=0, length?): ArrayBuffer \u5bf9\u8c61, \u5b57\u8282\u5e8f\u53f7, \u6570\u636e\u4e2a\u6570"),(0,r.kt)("li",{parentName:"ol"},"TypedArray(length): \u76f4\u63a5\u5206\u914d\u5185\u5b58\u751f\u6210"),(0,r.kt)("li",{parentName:"ol"},"TypedArray(typedArray): \u63a5\u53d7\u53e6\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"li"},"TypedArray"),"\u5b9e\u4f8b\u4f5c\u4e3a\u53c2\u6570. \u6b64\u65f6\u5bf9\u5e94\u7684\u6b64\u7b49\u5185\u5b58\u662f\u4e0d\u4e00\u6837\u7684, \u4f1a\u5f00\u8f9f\u4e00\u6bb5\u65b0\u7684\u5185\u5b58\u5b58\u50a8\u6570\u636e, \u4e0d\u4f1a\u518d\u539f\u6570\u7ec4\u7684\u5185\u5b58\u4e4b\u4e0a\u5efa\u7acb\u89c6\u56fe."),(0,r.kt)("li",{parentName:"ol"},"TypedArray(arrayLikeObject): \u63a5\u53d7\u4e00\u4e2a\u666e\u901a\u6570\u7ec4, \u7136\u540e\u76f4\u63a5\u751f\u6210",(0,r.kt)("inlineCode",{parentName:"li"},"TypedArray"),"\u5b9e\u4f8b.")),(0,r.kt)("p",null,"\u5f53\u7136 TypedArray \u6570\u7ec4\u4e5f\u53ef\u4ee5\u8f6c\u6362\u56de\u666e\u901a\u6570\u7ec4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const normalArray = [...typedArray];\n// or\nconst normalArray = Array.from(typedArray);\n// or\nconst normalArray = Array.prototype.slice.call(typedArray);\n")),(0,r.kt)("p",null,"\u51e0\u4e4e\u6240\u6709\u7684\u6570\u7ec4\u65b9\u6cd5\u90fd\u53ef\u4ee5\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u4e0a\u4f7f\u7528, \u4f46\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"TYpedArray"),"\u6ca1\u6709",(0,r.kt)("inlineCode",{parentName:"p"},"concat"),"\u65b9\u6cd5, \u5982\u679c\u60f3\u8981\u5408\u5e76\u591a\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6570\u7ec4, \u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9\u4e2a\u65b9\u6cd5:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function concatenate(resultConstructor, ...arrays) {\n    let totalLength = 0;\n    for (let arr of arrays) {\n        totalLength += arr.length;\n    }\n    let result = new resultConstructor(totalLength);\n    let offset = 0;\n    for (let arr of arrays) {\n        result.set(arr, offset);\n        offset += arr.length;\n    }\n    return result;\n}\n\nconcatenate(Uint8Array, Uint8Array.of(1, 2), Uint8Array.of(3, 4));\n// Uint8Array [1, 2, 3, 4]\n")),(0,r.kt)("p",null,"\u6b64\u5916, ",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6570\u7ec4\u4e0e\u666e\u901a\u6570\u7ec4\u4e00\u6837, \u90e8\u7f72\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"Iterator"),"\u63a5\u53e3, \u6240\u4ee5\u53ef\u4ee5\u88ab\u904d\u5386."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let ui8 = Uint8Array.of(0, 1, 2);\nfor (let byte of ui8) {\n    console.log(byte);\n}\n// 0\n// 1\n// 2\n")),(0,r.kt)("h3",{id:"62typedarray-\u65b9\u6cd5"},"6.2TypedArray \u65b9\u6cd5"),(0,r.kt)("h4",{id:"621-typedarrayprototypebuffer"},"6.2.1 TypedArray.prototype.buffer"),(0,r.kt)("p",null,"\u8be5\u65b9\u6cd5\u8fd4\u56de\u6574\u6bb5\u5185\u5b58\u533a\u57df\u5bf9\u5e94\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5bf9\u8c61, \u5f52\u5c5e\u6027\u4e3a\u53ea\u8bfb\u5c5e\u6027:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const a = new Float32Array(64);\nconst b = new Uint8Array(a.buffer);\n")),(0,r.kt)("h4",{id:"622-typedarrayprototypebytelengthtypedarrayprototypebyteoffset"},"6.2.2 TypedArray.prototype.byteLength\uff0cTypedArray.prototype.byteOffset"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"byteLength"),"\u5c5e\u6027\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6570\u7ec4\u5360\u636e\u7684\u5185\u5b58\u957f\u5ea6, \u5355\u4f4d\u4e3a\u5b57\u8282. ",(0,r.kt)("inlineCode",{parentName:"p"},"byteOffset"),"\u5c5e\u6027\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6570\u7ec4\u4ece\u5e95\u5c42",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5bf9\u8c61\u7684\u54ea\u4e2a\u5b57\u8282\u5f00\u59cb, \u8fd9\u4e24\u4e2a\u5c5e\u6027\u90fd\u53ea\u662f\u53ea\u8bfb\u5c5e\u6027."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const b = new ArrayBuffer(8);\n\nconst v1 = new Int32Array(b);\nconst v2 = new Uint8Array(b, 2);\nconst v3 = new Int16Array(b, 2, 2);\n\nv1.byteLength; // 8\nv2.byteLength; // 6\nv3.byteLength; // 4\n\nv1.byteOffset; // 0\nv2.byteOffset; // 2\nv3.byteOffset; // 2\n")),(0,r.kt)("h4",{id:"623-typedarrayprototypelength"},"6.2.3 TypedArray.prototype.length"),(0,r.kt)("p",null,"\u8be5\u5c5e\u6027\u8868\u793a",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6570\u7ec4\u542b\u6709\u591a\u5c11\u4e2a\u6210\u5458, \u6ce8\u610f\u5c06",(0,r.kt)("inlineCode",{parentName:"p"},"length"),"\u5c5e\u6027\u548c",(0,r.kt)("inlineCode",{parentName:"p"},"byteLength"),"\u5c5e\u6027\u533a\u5206, \u524d\u8005\u662f\u6210\u5458\u957f\u5ea6, \u540e\u8005\u662f\u5b57\u8282\u957f\u5ea6."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const a = new Int16Array(8);\n\na.length; // 8\na.byteLength; // 16\n")),(0,r.kt)("h4",{id:"624-typedarrayprototypeset"},"6.2.4 TypedArray.prototype.set()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\u7528\u4e8e\u590d\u5236\u6570\u636e, \u5c06\u4e00\u6bb5\u5185\u5bb9\u5b8c\u5168\u590d\u5236\u5230\u53e6\u4e00\u6bb5\u5185\u5b58:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const a = new Uint8Array(8);\nconst b = new Uint8Array(8);\n\nb.set(a);\n")),(0,r.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u590d\u5236 a \u6570\u7ec4\u7684\u5185\u5bb9\u5230 b \u6570\u7ec4\uff0c\u5b83\u662f\u6574\u6bb5\u5185\u5b58\u7684\u590d\u5236\uff0c\u6bd4\u4e00\u4e2a\u4e2a\u62f7\u8d1d\u6210\u5458\u7684\u90a3\u79cd\u590d\u5236\u5feb\u5f97\u591a\u3002"),(0,r.kt)("p",null,"set \u65b9\u6cd5\u8fd8\u53ef\u4ee5\u63a5\u53d7\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u8868\u793a\u4ece b \u5bf9\u8c61\u7684\u54ea\u4e00\u4e2a\u6210\u5458\u5f00\u59cb\u590d\u5236 a \u5bf9\u8c61\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const a = new Uint16Array(8);\nconst b = new Uint16Array(10);\n\nb.set(a, 2);\n")),(0,r.kt)("h4",{id:"625-typedarrayprototypesubarray"},"6.2.5 TypedArray.prototype.subarray()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"subarray"),"\u53ef\u4ee5\u9488\u5bf9",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u6570\u7ec4\u7684\u4e00\u90e8\u5206, \u518d\u5efa\u7acb\u4e00\u4e2a\u65b0\u7684\u89c6\u56fe:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const a = new Uint16Array(8);\nconst b = a.subarray(2, 3);\n\na.byteLength; // 16\nb.byteLength; // 2\n")),(0,r.kt)("h4",{id:"626-typedarrayprototypeslice"},"6.2.6 TypedArray.prototype.slice()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"slice"),"\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u6307\u5b9a\u4f4d\u7f6e\u7684\u65b0\u7684 TypedArray \u5b9e\u4f8b\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let ui8 = Uint8Array.of(0, 1, 2);\nui8.slice(-1);\n// Uint8Array [ 2 ]\n")),(0,r.kt)("h4",{id:"627-typedarrayof"},"6.2.7 TypedArray.of()"),(0,r.kt)("p",null,"\u7528\u4e8e\u5c06\u53c2\u6570\u8f6c\u4e3a\u4e00\u4e2a TypedArray \u5b9e\u4f8b:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Float32Array.of(0.151, -8, 3.7);\n// Float32Array [ 0.151, -8, 3.7 ]\n")),(0,r.kt)("h4",{id:"628-typedarrayfrom"},"6.2.8 TypedArray.from()"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Uint16Array.from([0, 1, 2]);\n// Uint16Array [ 0, 1, 2 ]\n")),(0,r.kt)("h2",{id:"7-\u590d\u5408\u89c6\u56fe"},"7. \u590d\u5408\u89c6\u56fe"),(0,r.kt)("p",null,'\u7531\u4e8e\u89c6\u56fe\u7684\u6784\u9020\u51fd\u6570\u53ef\u4ee5\u6307\u5b9a\u8d77\u59cb\u4f4d\u7f6e\u548c\u957f\u5ea6, \u6240\u4ee5\u5728\u540c\u4e00\u6bb5\u5185\u5b58\u4e4b\u4e2d, \u53ef\u4ee5\u4f9d\u6b21\u5b58\u653e\u4e0d\u540c\u7684\u6570\u636e, \u5c31\u53eb\u505a"\u590d\u5408\u89c6\u56fe":'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new ArrayBuffer(24);\n\nconst idView = new Uint32Array(buffer, 0, 1);\nconst usernameView = new Uint8Array(buffer, 4, 16);\nconst amountDueView = new Float32Array(buffer, 20, 1);\n")),(0,r.kt)("p",null,"\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u7528 c \u8bed\u8a00\u6765\u63cf\u8ff0\u5c31\u662f:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"struct someStruct {\n  unsigned long id;\n  char username[16];\n  float amountDue;\n};\n")),(0,r.kt)("h2",{id:"8-dataview-\u89c6\u56fe"},"8. DataView \u89c6\u56fe"),(0,r.kt)("p",null,"\u9664\u4e86\u4e0a\u9762\u90a3\u79cd\u590d\u5408\u89c6\u56fe, ",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5b9e\u9645\u4e0a\u63d0\u4f9b\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u6765\u521b\u5efa\u590d\u5408\u89c6\u56fe, \u5e76\u63d0\u4f9b\u4e86\u4e00\u4e9b\u64cd\u4f5c\u65b9\u6cd5:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u652f\u6301\u8bbe\u5b9a\u5b57\u8282\u5e8f. \u8bbe\u8ba1\u76ee\u7684\u5728\u4e8e\u5904\u7406\u7f51\u7edc\u8bbe\u5907\u4f20\u6765\u7684\u6570\u636e."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u672c\u8eab\u4e5f\u662f\u6784\u9020\u51fd\u6570, \u63a5\u53d7\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\u751f\u6210\u89c6\u56fe:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"DataView(ArrayBuffer buffer [, \u5b57\u8282\u8d77\u59cb\u4f4d\u7f6e [, \u957f\u5ea6]]);\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u5b9e\u4f8b\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027, \u542b\u4e49\u4e0e",(0,r.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\u76f8\u540c."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DataView.prototype.buffer"),":\u8fd4\u56de\u5bf9\u5e94\u7684 ArrayBuffer \u5bf9\u8c61"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DataView.prototype.byteLength"),":\u8fd4\u56de\u5360\u636e\u7684\u5185\u5b58\u5b57\u8282\u957f\u5ea6"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DataView.prototype.byteOffset"),":\u8fd4\u56de\u5f53\u524d\u89c6\u56fe\u4ece\u5bf9\u5e94\u7684 ArrayBuffer \u5bf9\u8c61\u7684\u54ea\u4e2a\u5b57\u8282\u5f00\u59cb")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u5b9e\u4f8b\u63d0\u4f9b 8 \u4e2a\u65b9\u6cd5\u8bfb\u53d6\u5185\u5b58:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getInt8"),":\u8bfb\u53d6 1 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a 8 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getUint8"),":\u8bfb\u53d6 1 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a\u65e0\u7b26\u53f7\u7684 8 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getInt16"),":\u8bfb\u53d6 2 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a 16 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getUint16"),":\u8bfb\u53d6 2 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a\u65e0\u7b26\u53f7\u7684 16 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getInt32"),":\u8bfb\u53d6 4 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a 32 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getUint32"),":\u8bfb\u53d6 4 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a\u65e0\u7b26\u53f7\u7684 32 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getFloat32"),":\u8bfb\u53d6 4 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a 32 \u4f4d\u6d6e\u70b9\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getFloat64"),":\u8bfb\u53d6 8 \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u4e00\u4e2a 64 \u4f4d\u6d6e\u70b9\u6570")),(0,r.kt)("p",null,"\u8fd9\u4e00\u7cfb\u5217",(0,r.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u7684\u53c2\u6570\u90fd\u662f\u4e00\u4e2a\u5b57\u8282\u5e8f\u53f7, \u8868\u793a\u4ece\u54ea\u4e2a\u5b57\u8282\u5f00\u59cb\u8bfb\u53d6."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const buffer = new ArrayBuffer(24);\nconst dv = new DataView(buffer);\n\n// \u4ece\u7b2c1\u4e2a\u5b57\u8282\u8bfb\u53d6\u4e00\u4e2a8\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\nconst v1 = dv.getUint8(0);\n\n// \u4ece\u7b2c2\u4e2a\u5b57\u8282\u8bfb\u53d6\u4e00\u4e2a16\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\nconst v2 = dv.getUint16(1);\n\n// \u4ece\u7b2c4\u4e2a\u5b57\u8282\u8bfb\u53d6\u4e00\u4e2a16\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\nconst v3 = dv.getUint16(3);\n")),(0,r.kt)("p",null,"\u5982\u679c\u4e00\u6b21\u8bfb\u53d6\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u5b57\u8282, \u51e0\u5fc5\u987b\u660e\u786e\u6570\u636e\u7684\u5b58\u50a8\u65b9\u5f0f, \u5230\u5e95\u662f\u5c0f\u7aef\u5b57\u8282\u5e8f\u8fd8\u662f\u5927\u7aef\u5b57\u8282\u5e8f. \u9ed8\u8ba4\u4e0b, ",(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u662f\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u662f\u4f7f\u7528\u5927\u7aef\u5b57\u8282\u5e8f\u89e3\u8bfb\u6570\u636e, \u5982\u679c\u9700\u8981\u4f7f\u7528\u5c0f\u7aef\u5b57\u8282\u5e8f\u89e3\u8bfb, \u5fc5\u987b\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6307\u5b9a",(0,r.kt)("inlineCode",{parentName:"p"},"true"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u5c0f\u7aef\u5b57\u8282\u5e8f\nconst v1 = dv.getUint16(1, true);\n\n// \u5927\u7aef\u5b57\u8282\u5e8f\nconst v2 = dv.getUint16(3, false);\n\n// \u5927\u7aef\u5b57\u8282\u5e8f\nconst v3 = dv.getUint16(3);\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u89c6\u56fe\u63d0\u4f9b 8 \u4e2a\u65b9\u6cd5\u5199\u5165\u5185\u5b58:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setInt8"),":\u5199\u5165 1 \u4e2a\u5b57\u8282\u7684 8 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setUint8"),":\u5199\u5165 1 \u4e2a\u5b57\u8282\u7684 8 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setInt16"),":\u5199\u5165 2 \u4e2a\u5b57\u8282\u7684 16 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setUint16"),":\u5199\u5165 2 \u4e2a\u5b57\u8282\u7684 16 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setInt32"),":\u5199\u5165 4 \u4e2a\u5b57\u8282\u7684 32 \u4f4d\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setUint32"),":\u5199\u5165 4 \u4e2a\u5b57\u8282\u7684 32 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setFloat32"),":\u5199\u5165 4 \u4e2a\u5b57\u8282\u7684 32 \u4f4d\u6d6e\u70b9\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setFloat64"),":\u5199\u5165 8 \u4e2a\u5b57\u8282\u7684 64 \u4f4d\u6d6e\u70b9\u6570\u3002")),(0,r.kt)("p",null,"\u8fd9\u4e00\u7cfb\u5217",(0,r.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\u7c7b\u4f3c",(0,r.kt)("inlineCode",{parentName:"p"},"get"),", \u63a5\u53d7\u4e24\u4e2a\u53c2\u6570, \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u5b57\u8282\u5e8f\u5217, \u8868\u793a\u4ece\u54ea\u4e2a\u5b57\u8282\u5f00\u59cb\u5199\u5165, \u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u5199\u5165\u7684\u6570\u636e. \u5bf9\u4e8e\u90a3\u4e9b\u5199\u5165\u4e24\u4e2a\u4ee5\u4e0a\u5b57\u8282\u7684\u65b9\u6cd5, \u9700\u8981\u5728\u7b2c\u4e09\u4e2a\u53c2\u6570\u6307\u5b9a, ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"\u548c",(0,r.kt)("inlineCode",{parentName:"p"},"undefined"),"\u8868\u793a\u5927\u7aef\u5b57\u8282\u5e8f, ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),"\u8868\u793a\u5c0f\u7aef\u5b57\u8282\u5e8f."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u5728\u7b2c1\u4e2a\u5b57\u8282\uff0c\u4ee5\u5927\u7aef\u5b57\u8282\u5e8f\u5199\u5165\u503c\u4e3a25\u768432\u4f4d\u6574\u6570\ndv.setInt32(0, 25, false);\n\n// \u5728\u7b2c5\u4e2a\u5b57\u8282\uff0c\u4ee5\u5927\u7aef\u5b57\u8282\u5e8f\u5199\u5165\u503c\u4e3a25\u768432\u4f4d\u6574\u6570\ndv.setInt32(4, 25);\n\n// \u5728\u7b2c9\u4e2a\u5b57\u8282\uff0c\u4ee5\u5c0f\u7aef\u5b57\u8282\u5e8f\u5199\u5165\u503c\u4e3a2.5\u768432\u4f4d\u6d6e\u70b9\u6570\ndv.setFloat32(8, 2.5, true);\n")),(0,r.kt)("p",null,"\u4e0d\u786e\u5b9a\u5b57\u8282\u5e8f\u7684\u8bdd, \u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\u8fdb\u884c\u5224\u65ad:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const littleEndian = (function() {\n    const buffer = new ArrayBuffer(2);\n    new DataView(buffer).setInt16(0, 256, true);\n    return new Int16Array(buffer)[0] === 256;\n})();\n")),(0,r.kt)("p",null,"\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"true"),"\u4e3a\u5c0f\u7aef\u5b57\u8282\u5e8f, \u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"\u4e3a\u5927\u7aef\u5b57\u8282\u5e8f."),(0,r.kt)("h2",{id:"9-arraybuffer-\u7684\u5e94\u7528"},"9. ArrayBuffer \u7684\u5e94\u7528"),(0,r.kt)("h3",{id:"91-ajax"},"9.1 Ajax"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest"),"\u7b2c\u4e8c\u7248",(0,r.kt)("inlineCode",{parentName:"p"},"XHR2"),"\u5141\u8bb8\u670d\u52a1\u5668\u8fd4\u56de\u4e8c\u8fdb\u5236\u6570\u636e, \u5982\u679c\u660e\u786e\u77e5\u9053\u8fd4\u56de\u4e8c\u8fdb\u5236\u6570\u636e\u7c7b\u578b, \u53ef\u4ee5\u628a\u8fd4\u56de\u7c7b\u578b",(0,r.kt)("inlineCode",{parentName:"p"},"responseType"),"\u8bbe\u7f6e\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"arraybuffer"),", \u5982\u679c\u4e0d\u77e5\u9053\u5c31\u8bbe\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"blob")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let xhr = new XMLHttpRequest();\nxhr.open('GET', someUrl);\nxhr.responseType = 'arraybuffer';\n\nxhr.onload = function() {\n    let arrayBuffer = xhr.response;\n    // \xb7\xb7\xb7\n};\n\nxhr.send();\n")),(0,r.kt)("p",null,"\u5982\u679c\u77e5\u9053\u4f20\u56de\u6765\u7684\u662f 32 \u4f4d\u6574\u6570, \u53ef\u4ee5\u5411\u8fd9\u6837\u5904\u7406:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"xhr.onreadystatechange = function() {\n    if (req.readyState === 4) {\n        const arrayResponse = xhr.response;\n        const dataView = new DataView(arrayResponse);\n        const ints = new Uint32Array(dataView.byteLength / 4);\n\n        xhrDiv.style.backgroundColor = '#00FF00';\n        xhrDiv.innerText = 'Array is ' + ints.length + 'uints long';\n    }\n};\n")),(0,r.kt)("h3",{id:"92-canvas"},"9.2 Canvas"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"canvas"),"\u5143\u7d20\u8f93\u51fa\u7684\u4e8c\u8fdb\u5236\u50cf\u7d20\u6570\u636e, \u5c31\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"typedArray"),"\u6570\u7ec4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const canvas = document.getElementById('myCanvas');\nconst ctx = canvas.getContext('2d');\n\nconst imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\nconst uint8ClampedArray = imageData.data;\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"uint8ClampedArray"),"\u662f\u4e00\u79cd\u9488\u5bf9",(0,r.kt)("inlineCode",{parentName:"p"},"canvsa"),"\u8f6c\u60a0\u7684\u7c7b\u578b, \u7279\u70b9\u662f\u9488\u5bf9\u989c\u8272, \u628a\u6bcf\u4e2a\u5b57\u8282\u89e3\u8bfb\u4e3a\u65e0\u7b26\u53f7\u7684 8 \u4f4d\u6574\u6570, \u5728\u53d1\u751f\u8fd0\u7b97\u7684\u65f6\u5019\u81ea\u52a8\u8fc7\u6ee4\u9ad8\u4f4d\u79fb\u9664, \u4e3a\u56fe\u50cf\u5904\u7406\u5e26\u6765\u4e86\u5de8\u5927\u7684\u65b9\u4fbf."),(0,r.kt)("p",null,"\u6bd4\u5982, \u5982\u679c\u628a\u50cf\u7d20\u7684\u989c\u8272\u503c\u8bbe\u7f6e",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8Array"),"\u7c7b\u578b, \u90a3\u4e48\u4e58\u4ee5\u4e00\u4e2a gamma, \u5c31\u5fc5\u987b\u8fd9\u6837\u8ba1\u7b97:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"u8[i] = Math.min(255, Math.max(0, u8[i] * gamma));\n")),(0,r.kt)("p",null,"\u800c\u53ea\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8ClampArray"),"\u5c31\u53ea\u9700\u8981:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"pixels[i] *= gamma;\n")),(0,r.kt)("h3",{id:"93-websocket"},"9.3 WebSocket"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"websocket"),"\u53ef\u4ee5\u901a\u8fc7",(0,r.kt)("inlineCode",{parentName:"p"},"arraybuffer"),"\u53d1\u9001\u6216\u8005\u63a5\u53d7\u4e8c\u8fdb\u5236\u6570\u636e:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let socket = new WebSocket('ws://127.0.0.1:8081');\nsocket.binaryType = 'arraybuffer';\n\n// Wait until socket is open\nsocket.addEventListener('open', function(event) {\n    // Send binary data\n    const typedArray = new Uint8Array(4);\n    socket.send(typedArray.buffer);\n});\n\n// Receive binary data\nsocket.addEventListener('message', function(event) {\n    const arrayBuffer = event.data;\n    // \xb7\xb7\xb7\n});\n")),(0,r.kt)("h3",{id:"94-fetch-api"},"9.4 Fetch Api"),(0,r.kt)("p",null,"FetchApi \u53d6\u56de\u7684\u6570\u636e\u5c31\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5bf9\u8c61:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"fetch(url)\n    .then(function(response) {\n        return response.arrayBuffer();\n    })\n    .then(function(arrayBuffer) {\n        // ...\n    });\n")),(0,r.kt)("h3",{id:"95-file-api"},"9.5 File Api"),(0,r.kt)("p",null,"\u5982\u679c\u77e5\u9053\u4e00\u4e2a\u6587\u4ef6\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u7c7b\u578b, \u4e5f\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u6587\u4ef6\u8bfb\u53d6\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u5bf9\u8c61."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const fileInput = document.getElementById('fileInput');\nconst file = fileInput.files[0];\nconst reader = new FileReader();\nreader.readAsArrayBuffer(file);\nreader.onload = function() {\n    const arrayBuffer = reader.result;\n    // \xb7\xb7\xb7\n};\n")),(0,r.kt)("p",null,"\u8fd9\u662f\u4e00\u4e2a\u8bfb\u53d6 BMP \u6587\u4ef6\u7684\u793a\u4f8b, \u5047\u5b9a file \u53d8\u91cf\u662f\u4e00\u4e2a\u6307\u5411 bmp \u6587\u4ef6\u7684\u6587\u4ef6\u5bf9\u8c61:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const reader = new FileReader();\nreader.addEventListener('load', processimage, false);\nreader.readAsArrayBuffer(file);\n")),(0,r.kt)("p",null,"\u7136\u540e\u5b9a\u4e49\u5904\u7406\u56fe\u50cf\u7684\u56de\u8c03\u51fd\u6570: \u7b80\u5386",(0,r.kt)("inlineCode",{parentName:"p"},"DataView"),"\u89c6\u56fe, \u5728\u5efa\u7acb\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"bitmap"),"\u5bf9\u8c61\u7528\u4e8e\u5b58\u653e\u5904\u7406\u540e\u7684\u6570\u636e, \u6700\u540e\u5c06\u56fe\u50cf\u5c55\u793a\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"canvas"),"\u5143\u7d20\u4e4b\u4e2d:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function processimage(e) {\n    const buffer = e.target.result;\n    const datav = new DataView(buffer);\n    const bitmap = {};\n    // \u5177\u4f53\u7684\u5904\u7406\u6b65\u9aa4\n}\n")),(0,r.kt)("p",null,"\u5177\u4f53\u5904\u7406\u56fe\u50cf\u6570\u636e, \u5148\u5904\u7406 bmp \u7684\u6587\u4ef6\u5934:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"bitmap.fileheader = {};\nbitmap.fileheader.bfType = datav.getUint16(0, true);\nbitmap.fileheader.bfSize = datav.getUint32(2, true);\nbitmap.fileheader.bfReserved1 = datav.getUint16(6, true);\nbitmap.fileheader.bfReserved2 = datav.getUint16(8, true);\nbitmap.fileheader.bfOffBits = datav.getUint32(10, true);\n")),(0,r.kt)("p",null,"\u5904\u7406\u56fe\u50cf\u56fe\u5143\u4fe1\u606f:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"bitmap.infoheader = {};\nbitmap.infoheader.biSize = datav.getUint32(14, true);\nbitmap.infoheader.biWidth = datav.getUint32(18, true);\nbitmap.infoheader.biHeight = datav.getUint32(22, true);\nbitmap.infoheader.biPlanes = datav.getUint16(26, true);\nbitmap.infoheader.biBitCount = datav.getUint16(28, true);\nbitmap.infoheader.biCompression = datav.getUint32(30, true);\nbitmap.infoheader.biSizeImage = datav.getUint32(34, true);\nbitmap.infoheader.biXPelsPerMeter = datav.getUint32(38, true);\nbitmap.infoheader.biYPelsPerMeter = datav.getUint32(42, true);\nbitmap.infoheader.biClrUsed = datav.getUint32(46, true);\nbitmap.infoheader.biClrImportant = datav.getUint32(50, true);\n")),(0,r.kt)("p",null,"\u6700\u540e\u5904\u7406\u56fe\u50cf\u672c\u8eab\u7684\u50cf\u7d20\u4fe1\u606f:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const start = bitmap.fileheader.bfOffBits;\nbitmap.pixels = new Uint8Array(buffer, start);\n")),(0,r.kt)("p",null,"\u7136\u540e\u4e0b\u4e00\u6b65\u5c31\u53ef\u4ee5\u6839\u636e\u9700\u8981\u8fdb\u884c\u56fe\u50cf\u53d8\u5f62\u6216\u8005\u8f6c\u6362\u683c\u5f0f."),(0,r.kt)("h3",{id:"96-sharedarraybuffer"},"9.6 SharedArrayBuffer"),(0,r.kt)("p",null,"\u6d4f\u89c8\u5668\u5f15\u5165\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"web worker"),"\u4f5c\u4e3a\u591a\u7ebf\u7a0b\u7684\u5b9e\u73b0."),(0,r.kt)("p",null,"\u4e0d\u540c\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"worder"),"\u7ebf\u7a0b\u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7",(0,r.kt)("inlineCode",{parentName:"p"},"postMessage"),"\u8fdb\u884c\u901a\u4fe1."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e3b\u7ebf\u7a0b\nconst w = new Worker('myworker.js');\n\n// \u4e3b\u7ebf\u7a0b\nw.postMessage('hi');\nw.onmessage = function(ev) {\n    console.log(ev.data);\n};\n\n// Worker \u7ebf\u7a0b\nonmessage = function(ev) {\n    console.log(ev.data);\n    postMessage('ho');\n};\n")),(0,r.kt)("p",null,"\u7ebf\u7a0b\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u6362\u53ef\u4ee5\u662f\u4e8c\u8fdb\u5236\u7684. \u8fd9\u79cd\u4ea4\u6362\u91c7\u7528\u7684\u662f\u590d\u5236\u673a\u5236, \u5728\u6570\u636e\u91cf\u8f83\u5927\u7684\u65f6\u5019\u4f1a\u6bd4\u8f83\u4f4e\u6548, \u6b64\u65f6\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"SharedArrayBuffer"),"(ES7), \u53ef\u4ee5\u8fd0\u884c worker \u5171\u4eab\u540c\u4e00\u5757\u5185\u5b58. \u8fbe\u5230\u6570\u636e\u5206\u4eab\u7684\u76ee\u7684. ",(0,r.kt)("inlineCode",{parentName:"p"},"SharedArrayBuffer"),"\u4e0e",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\u4e00\u6837, \u552f\u4e00\u7684\u533a\u522b\u5728\u4e8e\u540e\u8005\u65e0\u6cd5\u5171\u4eab\u6570\u636e."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e3b\u7ebf\u7a0b\n\n// \u65b0\u5efa 1KB \u5171\u4eab\u5185\u5b58\nconst sharedBuffer = new SharedArrayBuffer(1024);\n\n// \u4e3b\u7ebf\u7a0b\u5c06\u5171\u4eab\u5185\u5b58\u7684\u5730\u5740\u53d1\u9001\u51fa\u53bb\nw.postMessage(sharedBuffer);\n\n// \u5728\u5171\u4eab\u5185\u5b58\u4e0a\u5efa\u7acb\u89c6\u56fe\uff0c\u4f9b\u5199\u5165\u6570\u636e\nconst sharedArray = new Int32Array(sharedBuffer);\n\n// Worker \u7ebf\u7a0b\nonmessage = function(ev) {\n    // \u4e3b\u7ebf\u7a0b\u5171\u4eab\u7684\u6570\u636e\uff0c\u5c31\u662f 1KB \u7684\u5171\u4eab\u5185\u5b58\n    const sharedBuffer = ev.data;\n\n    // \u5728\u5171\u4eab\u5185\u5b58\u4e0a\u5efa\u7acb\u89c6\u56fe\uff0c\u65b9\u4fbf\u8bfb\u5199\n    const sharedArray = new Int32Array(sharedBuffer);\n\n    // ...\n};\n")),(0,r.kt)("h3",{id:"97-atomic-\u5bf9\u8c61"},"9.7. Atomic \u5bf9\u8c61"),(0,r.kt)("p",null,"\u591a\u7ebf\u7a0b\u5171\u4eab\u5185\u5b58, \u5c31\u4f1a\u51fa\u73b0\u5982\u4f55\u9632\u6b62\u4e24\u4e2a\u7ebf\u7a0b\u540c\u65f6\u4fee\u6539\u67d0\u4e2a\u5730\u5740\u7684\u95ee\u9898. ",(0,r.kt)("inlineCode",{parentName:"p"},"SharedArrayBuffer"),"API \u63d0\u4f9b",(0,r.kt)("inlineCode",{parentName:"p"},"Atomics"),'\u5bf9\u8c61, \u4fdd\u8bc1\u6240\u6709\u5171\u4eab\u5185\u5b58\u7684\u64cd\u4f5c\u90fd\u662f"\u539f\u5b50\u6027"\u7684, \u5e76\u4e14\u53ef\u4ee5\u5728\u6240\u6709\u7ebf\u7a0b\u5185\u540c\u6b65.'),(0,r.kt)("h4",{id:"971-atomicsstoreatomicsload"},"9.7.1 Atomics.store()\uff0cAtomics.load()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"store()"),"\u65b9\u6cd5\u7528\u6765\u5411\u5171\u4eab\u5185\u5b58\u5199\u5165\u6570\u636e, ",(0,r.kt)("inlineCode",{parentName:"p"},"load()"),"\u65b9\u6cd5\u7528\u6765\u4ece\u5171\u4eab\u5185\u5b58\u8bfb\u53d6\u6570\u636e."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Atomics.load(array, index);\nAtomics.store(array, index, value);\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"store"),"\u65b9\u6cd5\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570: ",(0,r.kt)("inlineCode",{parentName:"p"},"SharedBuffer"),"\u7684\u89c6\u56fe, \u4f4d\u7f6e\u7d22\u5f15\u548c\u503c, \u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"sharedArray[index]"),"\u7684\u503c."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"load"),"\u65b9\u6cd5\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570: ",(0,r.kt)("inlineCode",{parentName:"p"},"SharedBuffer"),"\u7684\u89c6\u56fe\u548c\u4f4d\u7f6e\u7d22\u5f15, \u4e5f\u662f\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"sharedArray[index]"),"\u7684\u503c."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e3b\u7ebf\u7a0b\nconst worker = new Worker('worker.js');\nconst length = 10;\nconst size = Int32Array.BYTES_PER_ELEMENT * length;\n// \u65b0\u5efa\u4e00\u6bb5\u5171\u4eab\u5185\u5b58\nconst sharedBuffer = new SharedArrayBuffer(size);\nconst sharedArray = new Int32Array(sharedBuffer);\nfor (let i = 0; i < 10; i++) {\n    // \u5411\u5171\u4eab\u5185\u5b58\u5199\u5165 10 \u4e2a\u6574\u6570\n    Atomics.store(sharedArray, i, 0);\n}\nworker.postMessage(sharedBuffer);\n\n// worker.js\nself.addEventListener(\n    'message',\n    event => {\n        const sharedArray = new Int32Array(event.data);\n        for (let i = 0; i < 10; i++) {\n            const arrayValue = Atomics.load(sharedArray, i);\n            console.log(`The item at array index ${i} is ${arrayValue}`);\n        }\n    },\n    false\n);\n")),(0,r.kt)("h4",{id:"972-atomicsexchange"},"9.7.2 Atomics.exchange()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"exchange"),"\u65b9\u6cd5\u662f\u9664\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"store"),"\u5916\u7684\u53e6\u4e00\u79cd\u5199\u5165\u6570\u636e\u7684\u65b9\u6cd5, \u533a\u522b\u5728\u4e8e",(0,r.kt)("inlineCode",{parentName:"p"},"store"),"\u8fd4\u56de\u5199\u5165\u7684\u503c, ",(0,r.kt)("inlineCode",{parentName:"p"},"exchange"),"\u8fd4\u56de\u88ab\u66ff\u6362\u7684\u503c."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Worker \u7ebf\u7a0b\nself.addEventListener(\n    'message',\n    event => {\n        const sharedArray = new Int32Array(event.data);\n        for (let i = 0; i < 10; i++) {\n            if (i % 2 === 0) {\n                const storedValue = Atomics.store(sharedArray, i, 1);\n                console.log(`The item at array index ${i} is now ${storedValue}`);\n            } else {\n                const exchangedValue = Atomics.exchange(sharedArray, i, 2);\n                console.log(`The item at array index ${i} was ${exchangedValue}, now 2`);\n            }\n        }\n    },\n    false\n);\n")),(0,r.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u5c06\u5171\u4eab\u5185\u5b58\u7684\u5076\u6570\u4f4d\u7f6e\u7684\u503c\u6539\u4e3a 1, \u5947\u6570\u4f4d\u7f6e\u7684\u503c\u6539\u4e3a 2"),(0,r.kt)("h4",{id:"973-atomicswaitatomicswake"},"9.7.3 Atomics.wait()\uff0cAtomics.wake()"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"wait"),"\u65b9\u6cd5\u548c",(0,r.kt)("inlineCode",{parentName:"p"},"wake"),"\u65b9\u6cd5\u7528\u4e8e\u7b49\u5f85\u901a\u77e5. \u8fd9\u4e24\u4e2a\u65b9\u6cd5\u76f8\u5f53\u4e8e\u9501\u5185\u5b58, \u8bb0\u8f7d\u4e00\u4e2a\u53bf\u57ce\u8fdb\u884c\u64cd\u4f5c\u65f6, \u8ba9\u5176\u4ed6\u7ebf\u7a0b\u4f11\u7720, \u7b49\u5230\u64cd\u4f5c\u7ed3\u675f, \u624d\u5524\u9192\u90a3\u4e9b\u4f11\u7720\u7684\u7ebf\u7a0b:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Worker \u7ebf\u7a0b\nself.addEventListener(\n    'message',\n    event => {\n        const sharedArray = new Int32Array(event.data);\n        const arrayIndex = 0;\n        const expectedStoredValue = 50;\n        Atomics.wait(sharedArray, arrayIndex, expectedStoredValue);\n        console.log(Atomics.load(sharedArray, arrayIndex));\n    },\n    false\n);\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"wait"),"\u65b9\u6cd5\u544a\u8bc9 worder \u53ea\u8981\u6ee1\u8db3\u7ed9\u5b9a\u6761\u4ef6, \u5c31\u5728\u8fd9\u4e00\u884c worder \u7ebf\u7a0b\u8fdb\u5165\u4f11\u7720."),(0,r.kt)("p",null,"\u4e3b\u7ebf\u7a0b\u4e00\u65e6\u66f4\u6539\u4e86\u6307\u5b9a\u4f4d\u7f6e\u7684\u503c, \u5c31\u53ef\u4ee5\u5524\u9192 Worker \u7ebf\u7a0b:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e3b\u7ebf\u7a0b\nconst newArrayValue = 100;\nAtomics.store(sharedArray, 0, newArrayValue);\nconst arrayIndex = 0;\nconst queuePos = 1;\nAtomics.wake(sharedArray, arrayIndex, queuePos);\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Atomics.wait()"),"\u65b9\u6cd5\u7684\u4f7f\u7528\u683c\u5f0f\u5982\u4e0b:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Atomics.wait(sharedArray, index, value, timeout);\n")),(0,r.kt)("p",null,"\u5206\u522b\u4e3a: \u5171\u4eab\u5185\u5b58\u7684\u89c6\u56fe\u6570\u7ec4, \u89c6\u56fe\u6570\u636e\u7684\u4f4d\u7f6e, \u8be5\u4f4d\u7f6e\u7684\u9884\u671f\u503c, \u7ecf\u8fc7\u591a\u5c11\u6beb\u79d2\u540e\u81ea\u52a8\u5524\u9192(\u9ed8\u8ba4\u65e0\u7a77\u5927)"),(0,r.kt)("p",null,"\u8fd4\u56de\u4e09\u79cd\u5b57\u7b26\u4e32:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c",(0,r.kt)("inlineCode",{parentName:"li"},"sharedArray[index]"),"\u4e0d\u7b49\u4e8e",(0,r.kt)("inlineCode",{parentName:"li"},"value"),", \u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"li"},"not-equal"),", \u5426\u5219\u8fdb\u5165\u4f11\u7720"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c",(0,r.kt)("inlineCode",{parentName:"li"},"wake"),"\u5524\u9192, \u5c31\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"li"},"ok")),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u8d85\u65f6\u5524\u9192, \u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"li"},"timed-out"))),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Atomice.wake()"),"\u65b9\u6cd5\u7684\u4f7f\u7528\u683c\u5f0f\u5982\u4e0b:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Atomics.wake(sharedArray, index, count);\n")),(0,r.kt)("p",null,"\u5206\u522b\u4e3a: \u5171\u4eab\u5185\u5b58\u7684\u89c6\u56fe\u6570\u7ec4, \u89c6\u56fe\u6570\u636e\u7684\u4f4d\u7f6e, \u9700\u8981\u5524\u9192\u7684 worker \u6570\u91cf(\u9ed8\u8ba4\u65e0\u7a77\u5927)"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"wake"),"\u65b9\u6cd5\u4e00\u65e6\u5524\u9192\u4f11\u7720\u7684 worder \u7ebf\u7a0b, \u5c31\u4f1a\u8ba9\u5b83\u7ee7\u7eed\u5f80\u4e0b\u8fd0\u884c."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e3b\u7ebf\u7a0b\nconsole.log(ia[37]); // 163\nAtomics.store(ia, 37, 123456);\nAtomics.wake(ia, 37, 1);\n\n// Worker \u7ebf\u7a0b\nAtomics.wait(ia, 37, 163);\nconsole.log(ia[37]); // 123456\n")),(0,r.kt)("h4",{id:"974-\u8fd0\u7b97\u65b9\u6cd5-add-sub-and-or-xor"},"9.7.4 \u8fd0\u7b97\u65b9\u6cd5: add, sub, and, or, xor"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Atomics.add(sharedArray, index, value)"),": \u5c06",(0,r.kt)("inlineCode",{parentName:"li"},"value"),"\u52a0\u5230",(0,r.kt)("inlineCode",{parentName:"li"},"sharedAttay[index]")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Atomics.sub(sharedArray, index, value)"),": \u5c06",(0,r.kt)("inlineCode",{parentName:"li"},"value"),"\u4ece",(0,r.kt)("inlineCode",{parentName:"li"},"sharedAttay[index]"),"\u51cf\u53bb"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Atomics.and(sharedArray, index, value)"),": \u5c06",(0,r.kt)("inlineCode",{parentName:"li"},"value"),"\u4e0e",(0,r.kt)("inlineCode",{parentName:"li"},"sharedAttay[index]"),"\u8fdb\u884c",(0,r.kt)("inlineCode",{parentName:"li"},"and"),"\u4f4d\u8fd0\u7b97"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Atomics.or(sharedArray, index, value)"),": \u5c06",(0,r.kt)("inlineCode",{parentName:"li"},"value"),"\u4e0e",(0,r.kt)("inlineCode",{parentName:"li"},"sharedAttay[index]"),"\u8fdb\u884c",(0,r.kt)("inlineCode",{parentName:"li"},"or"),"\u4f4d\u8fd0\u7b97"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Atomics.xor(sharedArray, index, value)"),": \u5c06",(0,r.kt)("inlineCode",{parentName:"li"},"value"),"\u4e0e",(0,r.kt)("inlineCode",{parentName:"li"},"sharedAttay[index]"),"\u8fdb\u884c",(0,r.kt)("inlineCode",{parentName:"li"},"xor"),"\u4f4d\u8fd0\u7b97")),(0,r.kt)("h4",{id:"975-\u5176\u4ed6\u65b9\u6cd5"},"9.7.5 \u5176\u4ed6\u65b9\u6cd5"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Atomics.compareExchange(sharedArray, index, oldval, newval)"),": \u5982\u679c",(0,r.kt)("inlineCode",{parentName:"li"},"sharedArray[index]"),"\u7b49\u4e8e",(0,r.kt)("inlineCode",{parentName:"li"},"oldval"),"\uff0c\u5c31\u5199\u5165",(0,r.kt)("inlineCode",{parentName:"li"},"newval"),"\uff0c\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"li"},"oldval"),", \u53ef\u4ee5\u7528\u4e8e\u4ece",(0,r.kt)("inlineCode",{parentName:"li"},"buffer"),"\u8bfb\u53d6\u4e00\u4e2a\u503c, \u5355\u540e\u5bf9\u8be5\u503c\u8fdb\u884c\u64cd\u4f5c, \u64cd\u4f5c\u5b8c\u68c0\u67e5\u503c\u662f\u5426\u53d1\u751f\u53d8\u5316."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Atomics.isLockFree(size)"),": \u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u8868\u793a",(0,r.kt)("inlineCode",{parentName:"li"},"Atomics"),"\u5bf9\u8c61\u662f\u5426\u53ef\u4ee5\u5904\u7406\u67d0\u4e2a",(0,r.kt)("inlineCode",{parentName:"li"},"size"),"\u7684\u5185\u5b58\u9501\u5b9a\u3002\u5982\u679c\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"li"},"false"),"\uff0c\u5e94\u7528\u7a0b\u5e8f\u5c31\u9700\u8981\u81ea\u5df1\u6765\u5b9e\u73b0\u9501\u5b9a\u3002")))}u.isMDXComponent=!0}}]);